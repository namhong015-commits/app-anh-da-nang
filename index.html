<!-- public/index.html -->
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI T·∫°o ·∫£nh t·ª´ m√¥ t·∫£</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; line-height: 1.45; margin: 24px; }
    textarea, select, input, button { font: inherit; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
    textarea { width: 100%; min-height: 120px; }
    .row { display: flex; gap: 12px; margin: 8px 0; flex-wrap: wrap; }
    button { background: #7c3aed; color: #fff; border: none; cursor: pointer; }
    button[disabled] { opacity: 0.6; cursor: not-allowed; }
    #result img { max-width: 100%; height: auto; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,.1); }
    .muted { color: #777; font-size: 14px; }
  </style>
</head>
<body>
  <h1>üñºÔ∏è AI T·∫°o ·∫£nh t·ª´ m√¥ t·∫£</h1>

  <label for="prompt"><b>M√¥ t·∫£ b·ª©c ·∫£nh</b></label>
  <textarea id="prompt" placeholder="V√≠ d·ª•: Phong c√°ch anime, √°nh s√°ng m·ªÅm. M·ªôt ch√∫ m√®o ƒë·ªôi m≈© phi h√†nh gia ƒëang bay trong v≈© tr·ª•."></textarea>

  <div class="row">
    <div>
      <label for="size">K√≠ch th∆∞·ªõc</label><br />
      <select id="size">
        <option value="1024x1024">1024√ó1024</option>
        <option value="1024x1536">1024√ó1536 (d·ªçc)</option>
        <option value="1536x1024">1536√ó1024 (ngang)</option>
        <option value="auto">Auto</option>
      </select>
    </div>

    <div>
      <label for="count">S·ªë ·∫£nh</label><br />
      <input id="count" type="number" min="1" max="4" value="1" />
    </div>
  </div>

  <button id="btn-generate" onclick="generate()">üöÄ T·∫°o ·∫£nh</button>

  <div id="result" class="muted" style="margin-top:16px;">Ch∆∞a c√≥ k·∫øt qu·∫£.</div>

  <script>
    async function generate() {
      const prompt = document.getElementById("prompt")?.value?.trim();
      const size = document.getElementById("size")?.value || "1024x1024";
      const n = parseInt(document.getElementById("count")?.value || "1", 10);

      if (!prompt) { alert("Vui l√≤ng nh·∫≠p m√¥ t·∫£ b·ª©c ·∫£nh!"); return; }

      const btn = document.getElementById("btn-generate");
      const out = document.getElementById("result");
      if (out) out.innerHTML = "‚è≥ ƒêang t·∫°o ·∫£nh‚Ä¶";
      if (btn) btn.disabled = true;

      try {
        const res = await fetch("/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt, size, n })
        });

        const data = await res.json();

        if (!res.ok) {
          throw new Error(data?.error || "L·ªói t·∫°o ·∫£nh");
        }

        const images = data?.images || data?.urls || [];
        if (!images.length) {
          out.innerHTML = "<i>Kh√¥ng nh·∫≠n ƒë∆∞·ª£c ·∫£nh tr·∫£ v·ªÅ.</i>";
          return;
        }

        out.innerHTML = images.map((src) => `<div style="margin:10px 0;"><img src="${src}" alt="result" /></div>`).join("");
      } catch (err) {
        console.error(err);
        out.innerHTML = `<span style="color:#d00">‚ùå ${err.message || "L·ªói kh√¥ng x√°c ƒë·ªãnh"}</span>`;
      } finally {
        if (btn) btn.disabled = false;
      }
    }
  </script>
</body>
</html>
